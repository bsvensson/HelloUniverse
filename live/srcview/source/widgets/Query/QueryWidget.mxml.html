<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>QueryWidget.mxml</title>
<link rel="stylesheet" type="text/css" href="../../../SourceStyles.css"/>
</head>

<body><pre><span class="MXMLProcessing_Instruction">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="MXMLComment">&lt;!--</span><span class="MXMLComment">
///////////////////////////////////////////////////////////////////////////
// Copyright (c) 2010-2011 Esri. All Rights Reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
///////////////////////////////////////////////////////////////////////////
</span><span class="MXMLComment">--&gt;</span>
<span class="MXMLComponent_Tag">&lt;viewer:BaseWidget</span><span class="MXMLDefault_Text"> xmlns:fx="</span><span class="MXMLString">http://ns.adobe.com/mxml/2009</span><span class="MXMLDefault_Text">"
                   xmlns:s="</span><span class="MXMLString">library://ns.adobe.com/flex/spark</span><span class="MXMLDefault_Text">"
                   xmlns:mx="</span><span class="MXMLString">library://ns.adobe.com/flex/mx</span><span class="MXMLDefault_Text">"
                   xmlns:Query="</span><span class="MXMLString">widgets.Query.*</span><span class="MXMLDefault_Text">"
                   xmlns:viewer="</span><span class="MXMLString">com.esri.viewer.*</span><span class="MXMLDefault_Text">"
                   initialize="</span><span class="ActionScriptDefault_Text">basewidget_initializeHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"
                   widgetConfigLoaded="</span><span class="ActionScriptDefault_Text">basewidget_widgetConfigLoaded</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>

    <span class="MXMLComponent_Tag">&lt;viewer:states&gt;</span>
        <span class="MXMLComponent_Tag">&lt;s:State</span><span class="MXMLDefault_Text"> name="</span><span class="MXMLString">resultsList</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
        <span class="MXMLComponent_Tag">&lt;s:State</span><span class="MXMLDefault_Text"> name="</span><span class="MXMLString">filterInput</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
    <span class="MXMLComponent_Tag">&lt;/viewer:states&gt;</span>

    <span class="MXMLComponent_Tag">&lt;viewer:transitions&gt;</span>
        <span class="MXMLComponent_Tag">&lt;s:Transition</span><span class="MXMLDefault_Text"> autoReverse="</span><span class="MXMLString">true</span><span class="MXMLDefault_Text">" toState="</span><span class="MXMLString">*</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:Fade</span><span class="MXMLDefault_Text"> targets="</span><span class="MXMLString">{</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">resultsList, filterInput</span><span class="ActionScriptBracket/Brace">]</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
        <span class="MXMLComponent_Tag">&lt;/s:Transition&gt;</span>
    <span class="MXMLComponent_Tag">&lt;/viewer:transitions&gt;</span>

    <span class="MXMLSpecial_Tag">&lt;fx:Script&gt;</span>
        &lt;![CDATA[
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FeatureSet</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Graphic</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Map</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clusterers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IClusterer</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LayerEvent</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Geometry</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MapPoint</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FeatureLayer</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FeatureCollection</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LayerDetails</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">portal</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PopUpRenderer</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">portal</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PopUpInfo</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">portal</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PopUpMediaInfo</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SimpleRenderer</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PictureMarkerSymbol</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SimpleFillSymbol</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SimpleLineSymbol</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Symbol</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tasks</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Query</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">viewer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ClustererParser</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">viewer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ErrorMessageUtil</span>;

            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">collections</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ArrayCollection</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlexEvent</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ModuleEvent</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">formatters</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DateFormatter</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rpc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AsyncResponder</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">StringUtil</span>;

            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">spark</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">components</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ItemRenderer</span>;

            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">widgets</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FeatureSetUtil</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">widgets</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ResultAttributes</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">widgets</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ResultItem</span>;

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">ICON_URL</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"assets/images/"</span>;

            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filterFieldAlias</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">msgVisible</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryResultAC</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>;

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filterField</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">infowidgetReady</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryExpr</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">orderByFields</span>:<span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">supportsServerSideSorting</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryLayer</span>:<span class="ActionScriptDefault_Text">FeatureLayer</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layerDetails</span>:<span class="ActionScriptDefault_Text">LayerDetails</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryFields</span>:<span class="ActionScriptDefault_Text">XMLList</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryLinkField</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryLinkAlias</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryRefreshRate</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryTitleField</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">timer</span>:<span class="ActionScriptDefault_Text">Timer</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">zoomScale</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 50000;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mouseDownStageX</span>:<span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mouseDownStageY</span>:<span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dateFormatter</span>:<span class="ActionScriptDefault_Text">DateFormatter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">DateFormatter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textDirection</span>:<span class="ActionScriptDefault_Text">String</span>;

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loadingLabel</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textFilterClear</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textFilterLabel</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">noResultLabel</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">featuresFoundLabel</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filterButtonLabel</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clearButtonLabel</span>:<span class="ActionScriptDefault_Text">String</span>;

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">resultFeatureLayer</span>:<span class="ActionScriptDefault_Text">FeatureLayer</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">resultMarkerSymbol</span>:<span class="ActionScriptDefault_Text">Symbol</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">resultLineSymbol</span>:<span class="ActionScriptDefault_Text">Symbol</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">resultFillSymbol</span>:<span class="ActionScriptDefault_Text">Symbol</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">shareResults</span>:<span class="ActionScriptDefault_Text">Boolean</span>;

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">popUpRenderer</span>:<span class="ActionScriptDefault_Text">PopUpRenderer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PopUpRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">graphicToResultAttributes</span>:<span class="ActionScriptDefault_Text">Dictionary</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentFeatureSet</span>:<span class="ActionScriptDefault_Text">FeatureSet</span>;

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">basewidget_initializeHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isPartOfPanel</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">// if widget is part of "left", "right" or "bottom" panel
</span>                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">percentWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">percentHeight</span> <span class="ActionScriptOperator">=</span> 100;
                    <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">percentWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">percentHeight</span> <span class="ActionScriptOperator">=</span> 100;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">=</span> 300;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">basewidget_widgetConfigLoaded</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">textDirection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStyle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"direction"</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptDefault_Text">loadingLabel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loading</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loadinglabel</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"loadingLabel"</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// other widgets use "loadinglabel" in their xml and so should this, but since 2.1 was released with "loading", we'll keep QueryWidget slightly inconsistent
</span>                    <span class="ActionScriptDefault_Text">textFilterLabel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterresults</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"filterTitleBarTooltip"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">textFilterClear</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterclear</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"showallTitleBarTooltip"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">filterButtonLabel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterbuttonlabel</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"filterButtonLabel"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">clearButtonLabel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clearbuttonlabel</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"clearButtonLabel"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">noResultLabel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">noresultlabel</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"noFeatures"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">featuresFoundLabel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">labels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">featuresfoundlabel</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"featuresFoundLabel"</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptDefault_Text">filterField</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterfield</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span>;
                    <span class="ActionScriptDefault_Text">filterFieldAlias</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterfield</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alias</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterfield</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layerURL</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layer</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">useAMF</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">useamf</span>;

                    <span class="ActionScriptDefault_Text">queryExpr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">query</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">queryExpr</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">// server requires query to have at least one of 'geometry', 'text', or 'where' properties set. In this widget we only use 'where', so make sure it is always set.
</span>                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">queryExpr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"1=1"</span>; <span class="ActionScriptComment">// ... is always true
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">queryFields</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fields</span>;
                    <span class="ActionScriptDefault_Text">queryTitleField</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">titlefield</span>;
                    <span class="ActionScriptDefault_Text">queryLinkField</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">linkfield</span>;
                    <span class="ActionScriptDefault_Text">queryLinkAlias</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">linkfield</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">alias</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptDefault_Text">queryRefreshRate</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">refreshrate</span>;

                    <span class="ActionScriptComment">//useproxy
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">useProxy</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">useproxy</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">useProxy</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">useproxy</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"true"</span>;
                    <span class="ActionScriptBracket/Brace">}</span>

                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">zoomscale</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">zoomScale</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">zoomscale</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>

                    <span class="ActionScriptComment">//marker symbol
</span>                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolURL</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">picturemarkersymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">widgetIcon</span>;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">parsedResultMarkerSymbolHeight</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">picturemarkersymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolHeight</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">parsedResultMarkerSymbolHeight</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 0 : <span class="ActionScriptDefault_Text">parsedResultMarkerSymbolHeight</span>;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">parsedResultMarkerSymbolWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">picturemarkersymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">parsedResultMarkerSymbolWidth</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 0 : <span class="ActionScriptDefault_Text">parsedResultMarkerSymbolWidth</span>;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolXOffset</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">picturemarkersymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">xoffset</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">picturemarkersymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">xoffset</span> : 0;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolYOffset</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">picturemarkersymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">yoffset</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">picturemarkersymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">yoffset</span> : 0;
                    <span class="ActionScriptDefault_Text">resultMarkerSymbol</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PictureMarkerSymbol</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultMarkerSymbolURL</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolHeight</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolXOffset</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultMarkerSymbolYOffset</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptComment">//line symbol
</span>                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultLineSymbolColor</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplelinesymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">||</span> 0xFF0000;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultLineSymbolAlpha</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplelinesymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplelinesymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">alpha</span> : 0.8;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultLineSymbolWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplelinesymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplelinesymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">width</span> : 2;
                    <span class="ActionScriptDefault_Text">resultLineSymbol</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SimpleLineSymbol</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SimpleLineSymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">STYLE_SOLID</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultLineSymbolColor</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultLineSymbolAlpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultLineSymbolWidth</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptComment">// fill symbol
</span>                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultFillSymbolColor</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">||</span> 0xFF0000;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultFillSymbolAlpha</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">alpha</span> : 0.5;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultFillSymbolOutlineColor</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outline</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">||</span> 0xFF0000;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultFillSymbolOutlineAlpha</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outline</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outline</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">alpha</span> : 0.8;
                    <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">resultFillSymbolOutlineWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outline</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">simplefillsymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outline</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">width</span> : 2;
                    <span class="ActionScriptDefault_Text">resultFillSymbol</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SimpleFillSymbol</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SimpleFillSymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">STYLE_SOLID</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultFillSymbolColor</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultFillSymbolAlpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SimpleLineSymbol</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SimpleLineSymbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">STYLE_SOLID</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultFillSymbolOutlineColor</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultFillSymbolOutlineAlpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultFillSymbolOutlineWidth</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">orderByFieldsText</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">orderbyfields</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">orderByFieldsText</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">orderByFields</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">orderByFieldsText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">','</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>

                    <span class="ActionScriptComment">// share results
</span>                    <span class="ActionScriptDefault_Text">shareResults</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">shareresults</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">shareresults</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"true"</span>;

                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">layerURL</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">queryLayer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FeatureLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLayer_loadHandler</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD_ERROR</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLayer_loadErrorHandler</span><span class="ActionScriptBracket/Brace">)</span>;

                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useProxy</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">configData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">proxyUrl</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">proxyURL</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">proxyUrl</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useAMF</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">useAMF</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">useAMF</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"true"</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryRefreshRate</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">disableClientCaching</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>; <span class="ActionScriptComment">// turn on only if using a refresh timer
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryFields</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">queryFields</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">all</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"true"</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outFields</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptString">"*"</span> <span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryFields</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fields</span>:<span class="ActionScriptDefault_Text">XMLList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">queryFields</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">field</span>;
                            <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outFields</span> <span class="ActionScriptOperator">=</span> [];
                            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fieldXML</span>:<span class="ActionScriptDefault_Text">XML</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">fields</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fieldXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>
                                <span class="ActionScriptBracket/Brace">{</span>
                                    <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outFields</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fieldXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">@</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                                <span class="ActionScriptBracket/Brace">}</span>
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">layerURL</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FeatureLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">visible</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">isEditable</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;

                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layerName</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layername</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">widgetTitle</span>;
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">shareResults</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">layerName</span> : <span class="ActionScriptString">"hiddenLayer_"</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">layerName</span>;

                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clustererParser</span>:<span class="ActionScriptDefault_Text">ClustererParser</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ClustererParser</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clusterer</span>:<span class="ActionScriptDefault_Text">IClusterer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">clustererParser</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parseClusterer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">configXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clustering</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">clusterer</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clusterer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">clusterer</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">HIDE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultFeatureLayer_hideHandler</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">filterField</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addTitlebarButton</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ICON_URL</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"i_searchtext.png"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textFilterLabel</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">toggleFilterPanel</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addTitlebarButton</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ICON_URL</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"i_clear.png"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textFilterClear</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">doClear</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedTitlebarButtonIndex</span> <span class="ActionScriptOperator">=</span> 1;
                    <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"resultsList"</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">queryLayer_loadHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLayer_loadHandler</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD_ERROR</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLayer_loadErrorHandler</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptDefault_Text">layerDetails</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layerDetails</span>;
                <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">minScale</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptComment">// removing scale dependency
</span>                <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">maxScale</span> <span class="ActionScriptOperator">=</span> 0;
                <span class="ActionScriptDefault_Text">supportsServerSideSorting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">layerDetails</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">version</span> <span class="ActionScriptOperator">&gt;=</span> 10.1
                    <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportsAdvancedQueries</span>;
                <span class="ActionScriptDefault_Text">createAndStartWidgetTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">queryFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">queryLayer_loadErrorHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLayer_loadHandler</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD_ERROR</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLayer_loadErrorHandler</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">errorMessage</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getDefaultString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"layerFailedToLoad"</span><span class="ActionScriptOperator">,</span>
                                                           <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">,</span>
                                                           <span class="ActionScriptDefault_Text">ErrorMessageUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">makeHTMLSafe</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ErrorMessageUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">buildFaultMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fault</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptDefault_Text">showError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">errorMessage</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">resultFeatureLayer_hideHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">hideInfoWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">infoError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">ModuleEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">errorText</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createAndStartWidgetTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryRefreshRate</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">timer</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">seconds</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryRefreshRate</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rate</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">seconds</span> <span class="ActionScriptOperator">*</span> 1000;
                        <span class="ActionScriptDefault_Text">timer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Timer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rate</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">timer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">TimerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TIMER</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">timerTick</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">timer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">stopWidgetTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">timer</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">timer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">running</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">timer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stop</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">startWidgetTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">timer</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">timer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">running</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">timer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">timerTick</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">TimerEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">queryFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">queryFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">graphicToResultAttributes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span>;

                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">query</span>:<span class="ActionScriptDefault_Text">Query</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Query</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">query</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">where</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">queryExpr</span>;
                    <span class="ActionScriptDefault_Text">query</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">outSpatialReference</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">spatialReference</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">supportsServerSideSorting</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">orderByFields</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">query</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">orderByFields</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">orderByFields</span>;
                    <span class="ActionScriptBracket/Brace">}</span>

                    <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">queryFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">query</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AsyncResponder</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">onResult</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onFault</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">loadingLabel</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featureSet</span>:<span class="ActionScriptDefault_Text">FeatureSet</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">token</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">try</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">supportsServerSideSorting</span>
                                <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">orderByFields</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">FeatureSetUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sortFeaturesByFieldName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featureSet</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">orderByFields</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>

                            <span class="ActionScriptDefault_Text">queryResultAC</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">createQueryResults</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featureSet</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptDefault_Text">addSharedData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">widgetTitle</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptBracket/Brace">)</span>;

                            <span class="ActionScriptDefault_Text">clearMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">noResultLabel</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                            <span class="ActionScriptReserved">else</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">StringUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substitute</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featuresFoundLabel</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">catch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">error</span>:<span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">error</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">message</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>

                    <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onFault</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">info</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">token</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">info</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createQueryResults</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featureSet</span>:<span class="ActionScriptDefault_Text">FeatureSet</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">currentFeatureSet</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">featureSet</span>;

                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">queryTitleField</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">queryTitleField</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">featureSet</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">displayFieldName</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">graphic</span>:<span class="ActionScriptDefault_Text">Graphic</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">featureSet</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">features</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">resultAttributes</span>:<span class="ActionScriptDefault_Text">ResultAttributes</span> <span class="ActionScriptOperator">=</span>
                        <span class="ActionScriptDefault_Text">ResultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toResultAttributes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryFields</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textDirection</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">graphic</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">featureSet</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLayer</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">widgetTitle</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryTitleField</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLinkField</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryLinkAlias</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">graphicToResultAttributes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">graphic</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">resultAttributes</span>;

                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">searchResult</span>:<span class="ActionScriptDefault_Text">ResultItem</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ResultItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphic</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">searchResult</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">infoWindowRenderer</span>:<span class="ActionScriptDefault_Text">ClassFactory</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ClassFactory</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PopUpRenderer</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">infoWindowRenderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">properties</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">popUpInfo</span>: <span class="ActionScriptDefault_Text">configurePopUpInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">}</span>;
                    <span class="ActionScriptDefault_Text">graphic</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindowRenderer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">infoWindowRenderer</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">visible</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">featureCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FeatureCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featureSet</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featureSet</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometryType</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">Geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MAPPOINT</span>:
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SimpleRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultMarkerSymbol</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">Geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">POLYLINE</span>:
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SimpleRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultLineSymbol</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">Geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">POLYGON</span>:
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SimpleRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultFillSymbol</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">result</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">configurePopUpInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultAttributes</span>:<span class="ActionScriptDefault_Text">ResultAttributes</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">PopUpInfo</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">popUpInfo</span>:<span class="ActionScriptDefault_Text">PopUpInfo</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PopUpInfo</span>;

                <span class="ActionScriptDefault_Text">popUpInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">title</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">title</span>;
                <span class="ActionScriptDefault_Text">popUpInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">description</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">link</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">link</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">linkAlias</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">linkAlias</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pos</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">link</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">-</span> 4;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sfx</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">link</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptOperator">,</span> 4<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toLowerCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">isImageLink</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sfx</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">".jpg"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sfx</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">".png"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sfx</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">".gif"</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isImageLink</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">popUpMediaInfo</span>:<span class="ActionScriptDefault_Text">PopUpMediaInfo</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PopUpMediaInfo</span>;
                        <span class="ActionScriptDefault_Text">popUpMediaInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">imageLinkURL</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">link</span>;
                        <span class="ActionScriptDefault_Text">popUpMediaInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">imageSourceURL</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">link</span>;
                        <span class="ActionScriptDefault_Text">popUpInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">popUpMediaInfos</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">popUpMediaInfo</span> <span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">linkText</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">linkAlias</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">linkAlias</span> : <span class="ActionScriptDefault_Text">link</span>;
                        <span class="ActionScriptDefault_Text">popUpInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">description</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">"&lt;br/&gt;&lt;a href='"</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">link</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"'&gt;"</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">linkText</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"&lt;/a&gt;"</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">popUpInfo</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hitimer</span>:<span class="ActionScriptDefault_Text">uint</span>;

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">mouseOverQueryResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">clearTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hitimer</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryResult</span>:<span class="ActionScriptDefault_Text">ResultItem</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ItemRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">ResultItem</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">containsXY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">center</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">center</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">// only show infowindow if query result in contained within map extent
</span>                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">hitimer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">setTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">showHighlight</span><span class="ActionScriptOperator">,</span> 300<span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">queryResult</span> <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">hideInfoWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">mouseOutQueryResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">clearTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hitimer</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">clickQueryResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryResult</span>:<span class="ActionScriptDefault_Text">ResultItem</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ItemRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">ResultItem</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MAPPOINT</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scale</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">zoomScale</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scale</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">zoomScale</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">centerAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">center</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extent</span>;

                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contains</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">level</span><span class="ActionScriptOperator">--</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">clearTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hitimer</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">hitimer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">setTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">showHighlight</span><span class="ActionScriptOperator">,</span> 300<span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">queryResult</span> <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">showHighlight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queryResult</span>:<span class="ActionScriptDefault_Text">ResultItem</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">showHighlightPoint</span>:<span class="ActionScriptDefault_Text">MapPoint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">center</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">MapPoint</span>;

                <span class="ActionScriptDefault_Text">popUpRenderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">popUpInfo</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">configurePopUpInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">popUpRenderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">graphic</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">graphic</span>;

                <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">popUpRenderer</span>;
                <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contentOwner</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">popUpRenderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">graphic</span>;
                <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">showHighlightPoint</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">msg</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">swfVisible</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">txtMessage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">msg</span>;
                <span class="ActionScriptDefault_Text">swfMessage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">visible</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">swfVisible</span>;
                <span class="ActionScriptDefault_Text">msgVisible</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">clearMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">msgVisible</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">widgetClosedHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">shareResults</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">visible</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">stopWidgetTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">hideInfoWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">widgetOpenedHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">shareResults</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">visible</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">startWidgetTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">toggleFilterPanel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"filterInput"</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">doFilter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">txtFilter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">features</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFeatureSet</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">features</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">filterResultFeatureLayer</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filteredFeatureSet</span>:<span class="ActionScriptDefault_Text">FeatureSet</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FeatureSet</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">features</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">featureCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FeatureCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">filteredFeatureSet</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterFunction</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">filterDataList</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">featureCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FeatureCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentFeatureSet</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">layerDetails</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">filterFunction</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">refresh</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptComment">// change it back to show the results
</span>                <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedTitlebarButtonIndex</span> <span class="ActionScriptOperator">=</span> 1;
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"resultsList"</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">noResultLabel</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">showMessage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">StringUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substitute</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">featuresFoundLabel</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">queryResultAC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">doClear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">wTemplate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedTitlebarButtonIndex</span> <span class="ActionScriptOperator">=</span> 1;
                <span class="ActionScriptDefault_Text">txtFilter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">''</span>;
                <span class="ActionScriptDefault_Text">doFilter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">filterResultFeatureLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">item</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">idx</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">arr</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">doesResultContainFilterText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphicToResultAttributes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">Graphic</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">item</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">doesResultContainFilterText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultAttributes</span>:<span class="ActionScriptDefault_Text">ResultAttributes</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">containsFilterText</span>:<span class="ActionScriptDefault_Text">RegExp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RegExp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">txtFilter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">'i'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">shouldInclude</span>:<span class="ActionScriptDefault_Text">Boolean</span>;

                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">filterField</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">shouldInclude</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span>
                        <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">containsFilterText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">test</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">filterField</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">shouldInclude</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">containsFilterText</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">test</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">resultAttributes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">shouldInclude</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">filterDataList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span>:<span class="ActionScriptDefault_Text">ResultItem</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">doesResultContainFilterText</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queryResult</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">hideInfoWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contentOwner</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                    <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contentOwner</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Graphic</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">Graphic</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contentOwner</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">graphicsLayer</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptDefault_Text">resultFeatureLayer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contentOwner</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Map</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hide</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">&gt;</span>
    <span class="MXMLSpecial_Tag">&lt;/fx:Script&gt;</span>

    <span class="MXMLComponent_Tag">&lt;viewer:WidgetTemplate</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">wTemplate</span><span class="MXMLDefault_Text">"
                           closed="</span><span class="ActionScriptDefault_Text">widgetClosedHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"
                           open="</span><span class="ActionScriptDefault_Text">widgetOpenedHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
        <span class="MXMLComponent_Tag">&lt;s:Group</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">resultsList</span><span class="MXMLDefault_Text">"
                 width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"
                 visible="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">"
                 visible.resultsList="</span><span class="MXMLString">true</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:layout&gt;</span>
                <span class="MXMLComponent_Tag">&lt;s:VerticalLayout</span><span class="MXMLDefault_Text"> gap="</span><span class="MXMLString">1</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComponent_Tag">&lt;/s:layout&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:HGroup</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">boxMessage</span><span class="MXMLDefault_Text">"
                      width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"
                      includeInLayout="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">msgVisible</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"
                      visible="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">msgVisible</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
                <span class="MXMLComponent_Tag">&lt;mx:Image</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">swfMessage</span><span class="MXMLDefault_Text">"
                          source="</span><span class="MXMLString">assets/images/loader.swf</span><span class="MXMLDefault_Text">"
                          visible="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
                <span class="MXMLComponent_Tag">&lt;s:Label</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">txtMessage</span><span class="MXMLDefault_Text">"
                         width="</span><span class="MXMLString">90%</span><span class="MXMLDefault_Text">"
                         text="</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComponent_Tag">&lt;/s:HGroup&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:Scroller</span><span class="MXMLDefault_Text"> width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
                <span class="MXMLComponent_Tag">&lt;Query:QueryResultDataGroup</span><span class="MXMLDefault_Text"> dataProvider="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">queryResultAC</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"
                                            queryResultClick="</span><span class="ActionScriptDefault_Text">clickQueryResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"
                                            queryResultMouseOut="</span><span class="ActionScriptDefault_Text">mouseOutQueryResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"
                                            queryResultMouseOver="</span><span class="ActionScriptDefault_Text">mouseOverQueryResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
                    <span class="MXMLComponent_Tag">&lt;Query:layout&gt;</span>
                        <span class="MXMLComponent_Tag">&lt;s:VerticalLayout</span><span class="MXMLDefault_Text"> gap="</span><span class="MXMLString">2</span><span class="MXMLDefault_Text">"
                                          horizontalAlign="</span><span class="MXMLString">justify</span><span class="MXMLDefault_Text">"
                                          useVirtualLayout="</span><span class="MXMLString">true</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
                    <span class="MXMLComponent_Tag">&lt;/Query:layout&gt;</span>
                <span class="MXMLComponent_Tag">&lt;/Query:QueryResultDataGroup&gt;</span>
            <span class="MXMLComponent_Tag">&lt;/s:Scroller&gt;</span>
        <span class="MXMLComponent_Tag">&lt;/s:Group&gt;</span>
        <span class="MXMLComponent_Tag">&lt;s:Group</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">filterInput</span><span class="MXMLDefault_Text">"
                 width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"
                 visible="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">"
                 visible.filterInput="</span><span class="MXMLString">true</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:layout&gt;</span>
                <span class="MXMLComponent_Tag">&lt;s:VerticalLayout</span><span class="MXMLDefault_Text"> gap="</span><span class="MXMLString">4</span><span class="MXMLDefault_Text">" horizontalAlign="</span><span class="MXMLString">center</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComponent_Tag">&lt;/s:layout&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:RichEditableText</span><span class="MXMLDefault_Text"> editable="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">" text="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">filterFieldAlias</span><span class="MXMLString">} : </span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:TextInput</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">txtFilter</span><span class="MXMLDefault_Text">"
                         width="</span><span class="MXMLString">98%</span><span class="MXMLDefault_Text">"
                         enter="</span><span class="ActionScriptDefault_Text">doFilter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComponent_Tag">&lt;s:HGroup</span><span class="MXMLDefault_Text"> width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" horizontalAlign="</span><span class="MXMLString">center</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
                <span class="MXMLComponent_Tag">&lt;s:Button</span><span class="MXMLDefault_Text"> click="</span><span class="ActionScriptDefault_Text">doFilter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">" label="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">filterButtonLabel</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
                <span class="MXMLComponent_Tag">&lt;s:Button</span><span class="MXMLDefault_Text"> click="</span><span class="ActionScriptDefault_Text">doClear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">" label="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">clearButtonLabel</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComponent_Tag">&lt;/s:HGroup&gt;</span>
        <span class="MXMLComponent_Tag">&lt;/s:Group&gt;</span>
    <span class="MXMLComponent_Tag">&lt;/viewer:WidgetTemplate&gt;</span>

<span class="MXMLComponent_Tag">&lt;/viewer:BaseWidget&gt;</span></pre></body>
</html>
